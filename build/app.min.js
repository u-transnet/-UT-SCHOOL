!function(t,e){function n(e,r){if("."!=e[0]&&"/"!=e[0])return t(e);r=r||"root";var i=n.resolve(e);if(!i&&/\.json$/i.test(e))return t("./"+n.basename(e));var o=n.cache[i];if(!o)try{return t(e)}catch(t){throw new Error('failed to require "'+e+'" from '+r+"\n"+t.message+"\n"+t.stack)}return o.exports||(o.exports={},o.call(o.exports,o,o.exports,n.relative(i))),o.exports}n.cache={},n.basename=t("path").basename,n.resolve=function(e){if("."!=e[0])return t.resolve(e);var r="/"===e.slice(-1)?e:e+"/",i=[e,e+".js",r+"index.js",e+".json",r+"index.json"];for(var o in i){var a=i[o];if(n.cache[a])return a}},n.register=function(t,e){n.cache[t]=e},n.relative=function(t){function e(e){if("."!=e[0])return n(e);var r=t.split("/"),i=e.split("/");for(var o in r.pop(),i){var a=i[o];".."==a?r.pop():"."!=a&&r.push(a)}return n(r.join("/"),t)}return e.resolve=n.resolve,e.cache=n.cache,e},n.register("./cli.js",function(t,e,n){"use strict";n("./cli/Api");var r,i=n("commander");((r=i)&&r.__esModule?r:{default:r}).default.version("1.0.0").option("-l, --login","login of your bitshares account").option("-p, --password","password of your bitshares account").option("-pvk, --private-key","private key of your bitshares account").parse(process.argv)}),n.register("./main.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("./api/Api");e.default=r.Api}),n.register("./api/Api.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Api=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n("../common/Account"),a=n("./StudentApi"),c=n("./TeacherApi"),u=n("./BlockchainApi"),s=n("bitsharesjs"),l=n("../common/Configs");var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.account=new o.Account(e,n),this.studentApi=new a.StudentApi(this.account),this.teacherApi=new c.TeacherApi(this.account)}return i(t,null,[{key:"init",value:function(e,n,r){var i=new t(n,r);return new Promise(function(t,n){u.BlockchainApi.init(e).then(function(){return t(i)}).catch(n)})}},{key:"generateKeys",value:function(t,e){return s.Login.generateKeys(t,e)}}]),i(t,[{key:"setPrivateKey",value:function(t){this.account.privateKey=t}},{key:"register",value:function(e,n){s.ChainValidation.required(l.utSchoolFaucet,"registrar_id");var i=t.generateKeys(e,n);return new Promise(function(t,n){return Promise.all([(0,s.FetchChain)("getAccount",l.utSchoolFaucet)]).then(function(n){var o=r(n,1)[0],a=new s.TransactionBuilder;a.add_type_operation("account_create",{fee:{amount:0,asset_id:0},registrar:o.get("id"),referrer:o.get("id"),name:e,owner:{weight_threshold:1,account_auths:[],key_auths:[[i.pubKeys.owner,1]],address_auths:[]},active:{weight_threshold:1,account_auths:[],key_auths:[[i.pubKeys.active,1]],address_auths:[]},options:{memo_key:i.pubKeys.memo,voting_account:"1.2.5",num_witness:0,num_committee:0,votes:[]}}),a.set_required_fees().then(function(){console.log("serialized transaction:",a.serialize()),a.broadcast(),t(a.serialize())})})})}}]),t}();e.Api=h}),n.register("./api/BitsharesApiExtends.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BitsharesApiExtends=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n("bitsharesjs-ws"),o=n("bitsharesjs");var a=o.ChainTypes.object_type,c=parseInt(a.operation_history,10),u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"_fetchHistory",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments[2],r=arguments[3],o=this,a=arguments[4],u=arguments[5];return void 0===r&&(r="1."+c+".0"),void 0===a&&(a="1."+c+".0"),new Promise(function(c,s){i.Apis.instance().history_api().exec("get_account_history",[t.get("id"),r,e,a]).then(function(r){var i=!0,a=!1,l=void 0;try{for(var h,f=r[Symbol.iterator]();!(i=(h=f.next()).done);i=!0){var d=h.value;d.op[0]!=n&&void 0!==n||u.push(d)}}catch(t){a=!0,l=t}finally{try{!i&&f.return&&f.return()}finally{if(a)throw l}}r.length==e?o._fetchHistory(t,e,n,void 0,r[0].id,u).then(c,s):c(u)})})}},{key:"fetchHistory",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments[2],r=arguments[3],i=arguments[4],a=t;if(!o.ChainValidation.is_object_id(a)&&t.toJS&&(a=t.get("id")),o.ChainValidation.is_object_id(a)&&(t=o.ChainStore.objects_by_id.get(a))){var c=o.ChainTypes.operations[n];if(void 0!==n&&void 0===c)throw new Error("unknown operation: "+n);return this._fetchHistory(t,e,c,r,i,[])}}}]),t}();e.BitsharesApiExtends=u}),n.register("./api/BlockchainApi.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BlockchainApi=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n("bitsharesjs"),o=n("bitsharesjs-ws");var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"init",value:function(t){return new Promise(function(e,n){o.Apis.instance(t,!0).init_promise.then(function(t){Promise.all([(new i.TransactionBuilder).update_head_block(),i.ChainStore.init()]).then(function(){console.log("connected to:",t[0].network_name,"network"),e()}).catch(n)}).catch(n)})}}]),t}();e.BlockchainApi=a}),n.register("./api/StudentApi.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StudentApi=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n("bitsharesjs"),a=n("./BitsharesApiExtends"),c=n("../common/Configs");var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.account=e,this.feeAsset="BTS"}return i(t,[{key:"applyForLecture",value:function(t){var e=this;return new Promise(function(n,i){Promise.all([(0,o.FetchChain)("getAccount",t),(0,o.FetchChain)("getAccount",e.account.name),(0,o.FetchChain)("getAsset",c.utSchoolTokenTicket),(0,o.FetchChain)("getAsset",e.feeAsset)]).then(function(t){var a=r(t,4),c=a[0],u=a[1],s=a[2],l=a[3],h=new o.TransactionBuilder;h.add_type_operation("transfer",{fee:{amount:0,asset_id:l.get("id")},from:c.get("id"),to:u.get("id"),amount:{asset_id:s.get("id"),amount:1}}),h.propose({fee_paying_account:u.get("id")}),h.set_required_fees().then(function(){h.add_signer(e.account.privateKey,e.account.privateKey.toPublicKey().toPublicKeyString()),h.broadcast().catch(i),n(h.serialize())}).catch(i)}).catch(i)})}},{key:"getLectureStats",value:function(t){var e=this;return new Promise(function(n,i){Promise.all([(0,o.FetchChain)("getAccount",t),(0,o.FetchChain)("getAccount",e.account.name),(0,o.FetchChain)("getAsset",[c.utSchoolTokenTicket,c.utSchoolTokenSession,c.utSchoolTokenGrade])]).then(function(t){var e=r(t,3),c=e[0],u=e[1],s=e[2],l=c.get("id"),h=u.get("id"),f={},d=!0,v=!1,y=void 0;try{for(var p,g=s[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var m=p.value;f[m.get("id")]={id:m.get("id"),symbol:m.get("symbol"),accepted:!1,balance:o.ChainStore.getAccountBalance(c,m.get("id"))}}}catch(t){v=!0,y=t}finally{try{!d&&g.return&&g.return()}finally{if(v)throw y}}a.BitsharesApiExtends.fetchHistory(l,100,"transfer").then(function(t){var e=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var c=o.value.op[1];c.from==l&&c.to==h&&f[c.amount.asset_id]&&(f[c.amount.asset_id].accepted=!0)}}catch(t){r=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(r)throw i}}n(f)}).catch(i)}).catch(i)})}},{key:"getLectures",value:function(){var t=this,e=[];return new Promise(function(n,i){Promise.all([(0,o.FetchChain)("getAccount",c.utSchoolAccount),(0,o.FetchChain)("getAsset",c.utSchoolToken)]).then(function(c){var u=r(c,2),s=u[0],l=u[1];s=s.get("id"),l=l.get("id"),a.BitsharesApiExtends.fetchHistory(s,100,"transfer").then(function(r){var a=[],c=!0,u=!1,h=void 0;try{for(var f,d=r[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value.op[1];v.from==s&&v.amount.asset_id==l&&a.push(v.to)}}catch(t){u=!0,h=t}finally{try{!c&&d.return&&d.return()}finally{if(u)throw h}}0!=a.length?(0,o.FetchChain)("getAccount",a).then(function(r){r=r.toJS();var a=[],c=!0,u=!1,s=void 0;try{for(var l,h=r[Symbol.iterator]();!(c=(l=h.next()).done);c=!0){var f=l.value;e.push({id:f.id,name:f.name,teacher:{id:f.active.account_auths[0][0]}}),a.push(f.active.account_auths[0][0])}}catch(t){u=!0,s=t}finally{try{!c&&h.return&&h.return()}finally{if(u)throw s}}(0,o.FetchChain)("getAccount",a).then(function(r){var o={};r=r.toJS();var a=!0,c=!1,u=void 0;try{for(var s,l=r[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var h=s.value;o[h.id]=h}}catch(t){c=!0,u=t}finally{try{!a&&l.return&&l.return()}finally{if(c)throw u}}var f=[],d=!0,v=!1,y=void 0;try{for(var p,g=e[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var m=p.value;m.teacher.name=o[m.teacher.id].name,f.push(t.getLectureStats(m.name))}}catch(t){v=!0,y=t}finally{try{!d&&g.return&&g.return()}finally{if(v)throw y}}Promise.all(f).then(function(t){for(var r=0;r<e.length;r++)e[r].stats=t[r];n(e)}).catch(i)}).catch(i)}).catch(i):n(e)}).catch(i)}).catch(i)})}}]),t}();e.StudentApi=u}),n.register("./api/TeacherApi.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TeacherApi=void 0;var r=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n("bitsharesjs"),a=n("./BitsharesApiExtends"),c=n("../common/Configs");var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.account=e,this.feeAsset="BTS"}return i(t,[{key:"_sendToken",value:function(t,e,n){var i=this;return new Promise(function(a,c){Promise.all([(0,o.FetchChain)("getAccount",t),(0,o.FetchChain)("getAccount",e),(0,o.FetchChain)("getAsset",n),(0,o.FetchChain)("getAsset",i.feeAsset)]).then(function(t){var e=r(t,4),n=e[0],u=e[1],s=e[2],l=e[3],h=new o.TransactionBuilder;h.add_type_operation("transfer",{fee:{amount:0,asset_id:l.get("id")},from:n.get("id"),to:u.get("id"),amount:{asset_id:s.get("id"),amount:1}}),h.set_required_fees().then(function(){h.add_signer(i.account.privateKey,i.account.privateKey.toPublicKey().toPublicKeyString()),h.broadcast().catch(c),a(h.serialize())}).catch(c)}).catch(c)})}},{key:"sendSessionToken",value:function(t,e){return this._sendToken(t,e,c.utSchoolTokenSession)}},{key:"sendGradeToken",value:function(t,e){return this._sendToken(t,e,c.utSchoolTokenGrade)}},{key:"requestTeacherRole",value:function(){var t=this;return new Promise(function(e,n){Promise.all([(0,o.FetchChain)("getAccount",c.utSchoolAccount),(0,o.FetchChain)("getAccount",t.account.name),(0,o.FetchChain)("getAsset",c.utSchoolToken),(0,o.FetchChain)("getAsset",t.feeAsset)]).then(function(i){var a=r(i,4),c=a[0],u=a[1],s=a[2],l=a[3],h=new o.TransactionBuilder;h.add_type_operation("transfer",{fee:{amount:0,asset_id:l.get("id")},from:c.get("id"),to:u.get("id"),amount:{asset_id:s.get("id"),amount:1}}),h.propose({fee_paying_account:u.get("id")}),h.set_required_fees().then(function(){h.add_signer(t.account.privateKey,t.account.privateKey.toPublicKey().toPublicKeyString()),h.broadcast().catch(n),e(h.serialize())}).catch(n)}).catch(n)})}},{key:"getLectureParticipants",value:function(t){return new Promise(function(e,n){Promise.all([(0,o.FetchChain)("getAccount",t),(0,o.FetchChain)("getAsset",c.utSchoolTokenTicket)]).then(function(t){var i=r(t,2),c=i[0],u=i[1];c=c.get("id"),u=u.get("id"),a.BitsharesApiExtends.fetchHistory(c,100,"transfer").then(function(t){var r=[],i=!0,a=!1,s=void 0;try{for(var l,h=t[Symbol.iterator]();!(i=(l=h.next()).done);i=!0){var f=l.value.op[1];f.from==c&&f.amount.asset_id==u&&r.push(f.to)}}catch(t){a=!0,s=t}finally{try{!i&&h.return&&h.return()}finally{if(a)throw s}}(0,o.FetchChain)("getAccount",r).then(function(t){t=t.toJS();var n={},i=!0,o=!1,a=void 0;try{for(var c,u=t[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var s=c.value;s&&(n[s.id]=s)}}catch(t){o=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}var l=[],h=!0,f=!1,d=void 0;try{for(var v,y=r[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var p=n[v.value];l.push({id:p.id,name:p.name})}}catch(t){f=!0,d=t}finally{try{!h&&y.return&&y.return()}finally{if(f)throw d}}e(l)}).catch(n)}).catch(n)}).catch(n)})}},{key:"getLectureApplications",value:function(t){return new Promise(function(e,n){Promise.all([(0,o.FetchChain)("getAccount",t),(0,o.FetchChain)("getAsset",c.utSchoolTokenTicket)]).then(function(t){var i=r(t,2),a=i[0],c=i[1],u=a.get("id");c=c.get("id");var s=a.toJS().proposals;if(0!=s.length){var l=[];(0,o.FetchChain)("getObject",s).then(function(t){t=t.toJS();var r=[],i=!0,a=!1,s=void 0;try{for(var h,f=t[Symbol.iterator]();!(i=(h=f.next()).done);i=!0){var d=h.value;if(!(Date.parse(d.proposed_transaction.expiration)<new Date/1e3)){var v=d.proposed_transaction.operations,y=void 0,p=!0,g=!1,m=void 0;try{for(var _,b=v[Symbol.iterator]();!(p=(_=b.next()).done);p=!0){var A=_.value[1];if(A.amount.asset_id==c&&A.from==u){y=A;break}}}catch(t){g=!0,m=t}finally{try{!p&&b.return&&b.return()}finally{if(g)throw m}}y&&(r.push(y.to),l.push({id:d.id,operation:y}))}}}catch(t){a=!0,s=t}finally{try{!i&&f.return&&f.return()}finally{if(a)throw s}}0!=l.length?(0,o.FetchChain)("getAccount",r).then(function(t){t=t.toJS();var n={},r=!0,i=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var u=a.value;u&&(n[u.id]=u)}}catch(t){i=!0,o=t}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}var s=!0,h=!1,f=void 0;try{for(var d,v=l[Symbol.iterator]();!(s=(d=v.next()).done);s=!0){var y=d.value,p=n[y.operation.to];delete y.operation,y.account={id:p.id,name:p.name}}}catch(t){h=!0,f=t}finally{try{!s&&v.return&&v.return()}finally{if(h)throw f}}e(l)}).catch(n):e([])}).catch(n)}else e([])}).catch(n)})}},{key:"acceptApplication",value:function(t){var e=this;return new Promise(function(n,i){Promise.all([(0,o.FetchChain)("getAccount",e.account.name),(0,o.FetchChain)("getAsset",e.feeAsset)]).then(function(a){var c=r(a,2),u=c[0],s=c[1],l=new o.TransactionBuilder;u=u.get("id"),l.add_type_operation("proposal_update",{fee:{amount:0,asset_id:s.get("id")},fee_paying_account:u,proposal:t,active_approvals_to_add:[u]}),l.set_required_fees().then(function(){l.add_signer(e.account.privateKey,e.account.privateKey.toPublicKey().toPublicKeyString()),l.broadcast().catch(i),n(l.serialize())}).catch(i)}).catch(i)})}},{key:"getLectureStats",value:function(t){return Promise.all([this.getLectureParticipants(t),this.getLectureApplications(t)])}},{key:"__processLectureQueue",value:function(t,e,n){var i=this;e>=t.length?n(t):this.getLectureStats(t[e].name).then(function(o){var a=r(o,2),c=a[0],u=a[1];t[e].participants=c,t[e].applications=u,i.__processLectureQueue(t,e+1,n)})}},{key:"getLectures",value:function(){var t=this;return new Promise(function(e,n){Promise.all([(0,o.FetchChain)("getAccount",c.utSchoolAccount),(0,o.FetchChain)("getAccount",t.account.name),(0,o.FetchChain)("getAsset",c.utSchoolToken)]).then(function(i){var c=r(i,3),u=c[0],s=c[1],l=c[2];u=u.get("id"),s=s.get("id"),l=l.get("id"),a.BitsharesApiExtends.fetchHistory(u,100,"transfer").then(function(r){var i=[],a=!0,c=!1,h=void 0;try{for(var f,d=r[Symbol.iterator]();!(a=(f=d.next()).done);a=!0){var v=f.value.op[1];v.from==u&&v.amount.asset_id==l&&i.push(v.to)}}catch(t){c=!0,h=t}finally{try{!a&&d.return&&d.return()}finally{if(c)throw h}}0!=i.length?(0,o.FetchChain)("getAccount",i).then(function(n){n=n.toJS();var r=[],i=!0,o=!1,a=void 0;try{for(var c,u=n[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var l=c.value;l.active.account_auths[0][0]==s&&r.push({id:l.id,name:l.name})}}catch(t){o=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(o)throw a}}0!=r.length?t.__processLectureQueue(r,0,e):e([])}).catch(n):e([])}).catch(n)}).catch(n)})}}]),t}();e.TeacherApi=u}),n.register("./cli/Api.js",function(t,e,n){"use strict"}),n.register("./cli/StudentApi.js",function(t,e,n){"use strict"}),n.register("./cli/TeacherApi.js",function(t,e,n){"use strict"}),n.register("./common/Account.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Account=void 0;var r=n("bitsharesjs");e.Account=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name=e,this.privateKey=n?r.PrivateKey.fromWif(n):""}}),n.register("./common/Configs.js",function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="UTSCHOOL";e.utSchoolToken=r,e.utSchoolTokenTicket="UTSCHOOL.TICKET",e.utSchoolTokenSession="UTSCHOOL.SESSION",e.utSchoolTokenGrade="UTSCHOOL.GRADE",e.utSchoolAccount="ut-school",e.utSchoolFaucet="u-tech-faucet"}),e.exports=n("./main.js")}(require,module);
//# sourceMappingURL=app.min.js.map
